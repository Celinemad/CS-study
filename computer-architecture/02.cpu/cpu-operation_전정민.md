## 1. 명령어 사이클

- CPU는 메모리로부터 명령어나 데이터를 가져와서 실행한다.
- 이것은 정해진 흐름대로 진행된다.
- 즉, CPU는 정해진 흐름대로 명령어를 처리하는데, 이 정해진 흐름을 끊는 신호가 인터럽트이다.
- 프로그램 속 명령어들은 일정한 주기가 반복되며 실행되고 이 주기를 명령어 사이클이라고 한다.

### 메모리에 있는 명령어를 실행하려면?

- CPU로 명령어를 가져와야 할 것이다. 이것을 인출 사이클이라고 한다.
- 갖고 왔으면 실행해야 할 것이고 이것을 실행 사이클이라고 한다.
- 기본적으로, 명령어 사이클은 이 인출 사이클과 실행 사이클이 반복되면서 진행된다.
- 하지만 명령어를 가져와서 바로 실행하지 못하고 몇 번 메모리에 접근해야하는 경우도 있다. 이를 위해서는 간접 사이클이 필요하다.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/e11f4eac-f83e-4911-a354-01d8604e4e59/09178f24-9e0a-47ef-baf5-7fa3b6d4e005/Untitled.png)

## 2. 인터럽트

- 위의 그림처럼 일정한 흐름대로 명령어 사이클이 진행되는데 이 사이클을 끊는 것이 인터럽트이다.
- 보통 CPU가 처리해야할 작업이 생겼을 때 인터럽트가 발생한다.

### 종류

- 크게 두 가지로 나뉜다.
    - 동기 인터럽트(예외)
    - 비동기 인터럽트(하드웨어 인터럽트)

### 동기 인터럽트

- CPU가 예기치 못한 상황을 접했을 때 발생한다.
- 이는 운영체제 파트에서 자세하게 다룬다.

### 비동기 인터럽트

- 주로 입출력 장치에 의해서 발생한다.
- 알림과 같은 역할을 한다.
    - 예를 들어, CPU가 프린터한테 자신은 다른 일을 하고 있을테니 입출력 작업이 완료되면 알려달라고 하고 잔신의 작업을 진행한다.
    - 그리고 프린터가 입출력 작업을 완료하면 알림처럼 CPU에 하드웨어 인터럽트를 보낸다.
- 인터럽트가 없었다면 CPU는 프린트 완료 여부를 확인하기 위해 주기적인 확인을 해야할 것이다. 즉, 입출력 작업 도중에도 효율적으로 명령어를 처리하기 위해 사용된다.

### 비동기 인터럽트의 처리 순서

1. 입출력 장치는 CPU에 인터럽트 요청 신호를 보낸다.
2. CPU는 실행 사이클이 끝나고 명령어를 인출하기 전 항상 인터럽트 여부를 확인한다.
3. CPU는 인터럽트 요청을 확인하고 인터럽트 플래그를 통해 현재 인터럽트를 받아들일 수 있는지 여부를 확인한다.
4. 인터럽트를 받아들일 수 있다면 지금까지의 작업을 백업한다.(스택에 백업)
5. CPU는 인터럽트 벡터를 참조하여 인터럽트 서비스 루틴을 실행한다.
6. 서비스 루틴이 끝나면 백업해둔 작업을 복구해 실행을 재개한다.

### 인터럽트 플래그

- 플래그 레지스터 중에 인터럽트 플래그가 있는데 이것의 여부를 통해 인터럽트를 받아들일지 아닐지 판단한다.
- 하지만 이 플래그로 모든 인터럽트를 막을 수 있는 것은 아니다.
- 하드웨어 고장이나 정전과 같은 것은 막을 수 없고 대부분의 입출력 장치에 의한 인터럽트는 막을 수 있다.

### 인터럽트 서비스 루틴

- 인터럽트가 발생했을 때, 해당 인터럽트를 어떻게 처리하기 위한 프로그램이다.
    - “키보드가 인터럽트 요청을 보내면 이렇게 해야한다” 등
- 인터럽트 서비스 루틴도 프로그램이기 때문에 메모리에 저장된다.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/e11f4eac-f83e-4911-a354-01d8604e4e59/158091d1-87e0-440f-b80e-ad84f4d9d9e6/Untitled.png)

### 인터럽트 벡터

- 각각의 인터럽트를 구분하기 위한 정보이다.
- 인터럽트를 보내는 주체에 따라서 인터럽트 서비스 루틴의 시작 주소가 달라질 수 있는데 CPU는 인터럽트 벡터를 통해서 이것을 구분할 수 있다.
- 인터럽트 벡터 테이블도 메모리에 있다.
- 입출력 장치가 인터럽트를 보낼 때 인터럽트 벡터도 같이 보낸다.

### 결론

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/e11f4eac-f83e-4911-a354-01d8604e4e59/8fb35479-42c3-496c-a42a-1434978dfd36/Untitled.png)

CPU는 결국 메모리에 있는 프로그램을 위와 같은 흐름에 따라서 처리한다.

## 3. JAVA와 C++

### C, C++의 경우

- c나 c++ 같은 언어는 컴파일된 기계어 코드가 CPU에서 실행된다.
- 컴파일러가 운영체제에 따라 다르기 때문에 각 컴파일러에 맞게 수정해야되는 상황이 있을 수도 있다.

### JAVA의 경우

- 컴파일러에 의해 바이트 코드로 번역된다.
- 이 바이트 코드는 특정 플랫폼에 종속되지 않고 중간 형태로 남아있다.
- 그런 다음, 바이트 코드를 각 운영체제에 맞는 맞는 JVM에 로드하여 기계어로 번역하여 실행한다.(JIT에 의해)
- CPU는 이 기계어 코드를 실행한다.
- 이러한 원리로 자바가 다양한 플랫폼에서 실행될 수 있는 것이다.

> **기계어는 하드웨어가 이해할 수 있는 컴퓨터 언어이고, 바이트 코드는 하드웨어가 아닌 가상 컴퓨터에서 실행시킬 수 있는 코드**
> 

### JVM과 CPU

- 자바 프로그램을 실행할 때 CPU는 기계어 코드 실행도 처리하고 JVM에서 발생하는 작업도 처리해야한다.
- JVM에서 일어나는 가비지 컬렉션, 스레드 관리 등이 CPU의 성능을 저하시킬 수 있다.